Training Memory Decision Transformer on velocity_cartpole...
Dataset stats: total=24912, train=22420, val=2492, state_dim=2, actions=2
Epoch 1/7: Train Loss=0.4756, Val Loss=0.3535
Running environment validation...
Episode 1: Return=28.0, Steps=28
Episode 2: Return=11.0, Steps=11
Episode 3: Return=11.0, Steps=11
Episode 4: Return=11.0, Steps=11
Episode 5: Return=12.0, Steps=12
Episode 6: Return=11.0, Steps=11
Episode 7: Return=11.0, Steps=11
Episode 8: Return=11.0, Steps=11
Episode 9: Return=12.0, Steps=12
Episode 10: Return=11.0, Steps=11
Validation: Mean Return=12.90, Success Rate=0.00%
New best model with return 12.90
Epoch 2/7: Train Loss=0.3676, Val Loss=0.3380
Running environment validation...
Episode 1: Return=500.0, Steps=500
Episode 2: Return=500.0, Steps=500
Episode 3: Return=13.0, Steps=13
Episode 4: Return=500.0, Steps=500
Episode 5: Return=500.0, Steps=500
Episode 6: Return=499.0, Steps=499
Episode 7: Return=500.0, Steps=500
Episode 8: Return=500.0, Steps=500
Episode 9: Return=12.0, Steps=12
Episode 10: Return=500.0, Steps=500
Validation: Mean Return=402.40, Success Rate=80.00%
New best model with return 402.40
Epoch 3/7: Train Loss=0.3365, Val Loss=0.3284
Running environment validation...
Episode 1: Return=500.0, Steps=500
Episode 2: Return=500.0, Steps=500
Episode 3: Return=500.0, Steps=500
Episode 4: Return=500.0, Steps=500
Episode 5: Return=500.0, Steps=500
Episode 6: Return=500.0, Steps=500
Episode 7: Return=500.0, Steps=500
Episode 8: Return=500.0, Steps=500
Episode 9: Return=500.0, Steps=500
Episode 10: Return=500.0, Steps=500
Validation: Mean Return=500.00, Success Rate=100.00%
New best model with return 500.00
Epoch 4/7: Train Loss=0.3258, Val Loss=0.3236
Running environment validation...
Episode 1: Return=500.0, Steps=500
Episode 2: Return=500.0, Steps=500
Episode 3: Return=500.0, Steps=500
Episode 4: Return=500.0, Steps=500
Episode 5: Return=500.0, Steps=500
Episode 6: Return=500.0, Steps=500
Episode 7: Return=500.0, Steps=500
Episode 8: Return=500.0, Steps=500
Episode 9: Return=500.0, Steps=500
Episode 10: Return=500.0, Steps=500
Validation: Mean Return=500.00, Success Rate=100.00%
Epoch 5/7: Train Loss=0.3202, Val Loss=0.3190
Running environment validation...
Episode 1: Return=500.0, Steps=500
Episode 2: Return=500.0, Steps=500
Episode 3: Return=500.0, Steps=500
Episode 4: Return=500.0, Steps=500
Episode 5: Return=500.0, Steps=500
Episode 6: Return=500.0, Steps=500
Episode 7: Return=500.0, Steps=500
Episode 8: Return=500.0, Steps=500
Episode 9: Return=500.0, Steps=500
Episode 10: Return=500.0, Steps=500
Validation: Mean Return=500.00, Success Rate=100.00%
Epoch 6/7: Train Loss=0.3174, Val Loss=0.3193
Running environment validation...
Episode 1: Return=500.0, Steps=500
Episode 2: Return=500.0, Steps=500
Episode 3: Return=500.0, Steps=500
Episode 4: Return=500.0, Steps=500
Episode 5: Return=500.0, Steps=500
Episode 6: Return=500.0, Steps=500
Episode 7: Return=500.0, Steps=500
Episode 8: Return=500.0, Steps=500
Episode 9: Return=500.0, Steps=500
Episode 10: Return=500.0, Steps=500
Validation: Mean Return=500.00, Success Rate=100.00%
Epoch 7/7: Train Loss=0.3161, Val Loss=0.3178
Running environment validation...
Episode 1: Return=500.0, Steps=500
Episode 2: Return=500.0, Steps=500
Episode 3: Return=500.0, Steps=500
Episode 4: Return=500.0, Steps=500
Episode 5: Return=500.0, Steps=500
Episode 6: Return=500.0, Steps=500
Episode 7: Return=500.0, Steps=500
Episode 8: Return=500.0, Steps=500
Episode 9: Return=500.0, Steps=500
Episode 10: Return=500.0, Steps=500
Validation: Mean Return=500.00, Success Rate=100.00%
Best model saved to models/memory_dt_velocity_cartpole_lstm_best.pt
Evaluating model on velocity_cartpole...
Episode 1: Return=500.0, Steps=500
Episode 2: Return=500.0, Steps=500
Episode 3: Return=500.0, Steps=500
Episode 4: Return=500.0, Steps=500
Episode 5: Return=500.0, Steps=500
Episode 6: Return=295.0, Steps=295
Episode 7: Return=500.0, Steps=500
Episode 8: Return=500.0, Steps=500
Episode 9: Return=500.0, Steps=500
Episode 10: Return=500.0, Steps=500
Episode 11: Return=500.0, Steps=500
Episode 12: Return=500.0, Steps=500
Episode 13: Return=500.0, Steps=500
Episode 14: Return=500.0, Steps=500
Episode 15: Return=500.0, Steps=500
Episode 16: Return=500.0, Steps=500
Episode 17: Return=500.0, Steps=500
Episode 18: Return=500.0, Steps=500
Episode 19: Return=500.0, Steps=500
Episode 20: Return=500.0, Steps=500
Evaluation Summary:
Mean Return: 489.75
Success Rate: 95.00%
Evaluation complete. Mean return: 489.75, Success rate: 95.00%
